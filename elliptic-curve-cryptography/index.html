<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8" />
    <meta name="author" content="Elijah Voigt">
    <link rel="stylesheet" type="text/css" href="../theme/css/styles.css"/>
        <link href="/rss.xml" type="application/rss+xml"   rel="alternate" title="elijahcaine.me RSS Feed" />
        <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="elijahcaine.me Atom Feed" />
  </head>

  <body>
    <div class="site">
      <header>
        <a href="/">(üè† elijahcaine.me)</a>
        <a href="https://github.com/pop/">(üêô github üê±)</a>
        <a href="/Elijah Voigt.pdf">(üëî resume)</a>
        <a href="/atom.xml">(üì∞ feed)</a>
      </header>

      <div id="content">

<div class="post">
  <h1 class="posttitle">
    Elliptic Curve Cryptography
  </h1>

  <div class="postinfo">
    <p class="published" title="2017-10-04T00:00:00-07:00">
      Wed 04 October 2017
    </p>
  </div>
</div>

<div class="article">
  <div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a part of a series of blog posts I wrote for an Independent Study on cryptography at Oregon State University.
To read all of the posts, check out the 'Independent Crypto' tag.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This post is jumps around a bit.
We'll start by showing how Elliptic Curve Cryptography works at a high level, then create a list of questions about how/why Elliptic Curve Cryptography works and how it is useful to cryptogrpahy.
Once those questions are answered we will end with a recap.
Hopefully we will zero in on what Elliptic Curves are and what Elliptic Curve Cryptography is.</p>
</div>
<div class="section" id="diffie-hellman-key-exchange">
<h2>Diffie-Hellman key exchange ++</h2>
<p>You find yourself day-dreaming during a walk around campus wondering if there is an alternative cryptography system to the very popular RSA.
You want something that has improved computational and network efficiency.
You want smaller keys that are harder to crack.
Could such a system exist?</p>
<p>You share this fantasy with a friend, you share all of your crypto fantasies with this friend, and they tell you that Elliptic Curve Cryptography is promising and it perfectly fits your needs.
... but how does it work?</p>
<div class="section" id="diffie-hellman-key-exchange-a-recap">
<h3>Diffie-Hellman key exchange (a recap)</h3>
<p>To create a useful crypto out of Elliptic Curves we need to implement <a class="reference external" href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange">Diffie‚ÄìHellman key exchange</a> (DHKE).
Once we have DHKE we more or less have a valid crypto system which we can build upon to encrypt and decrypt private information.</p>
<p>The reader (you) is assumed to be familiar with DHKE.
While DHKE is fairly simple, it is not unforgettable, so here is quick reminder:</p>
<ol class="arabic simple">
<li>Alice and Bob agree on a public modulus (p) and a base (g).</li>
<li>Alice and Bob both choose secret integers (a and b).</li>
<li>Alice sends Bob g<sup>a</sup> (mod p) (we call it A) and Bob sends Alice g<sup>b</sup> (mod p) (we call it B).</li>
<li>Alice computes B<sup>a</sup> (mod p) and Bob computes A<sup>b</sup> (mod p). These are equivalent (mod p). This is Alice and Bob's shared secret.</li>
</ol>
<p>How do we use Elliptic Curves get a similar 'shared secret'?</p>
</div>
<div class="section" id="elliptic-diffie-hellman-key-exchange">
<h3>Elliptic Diffie-Hellman key exchange</h3>
<p>At a (very) high level the algorithm is as follows:</p>
<ol class="arabic simple">
<li>Alice and Bob agree to use a given Elliptic Curve over a finite field, E(F<sub>p</sub>), and a public point P ‚àà E(F<sub>p</sub>).</li>
<li>Alice chooses a secret integer n<sub>A</sub> and Bob choose secret integers n<sub>B</sub>.</li>
<li>Alice computes Q<sub>A</sub> = n<sub>A</sub>P and Bob computes Q<sub>B</sub> = n<sub>B</sub>P. These are the &quot;Public Keys&quot;</li>
<li>Alice sends Bob her public key, Bob send Alice his public key.</li>
<li>Alice computes n<sub>A</sub>Q<sub>B</sub>, Bob computes n<sub>B</sub>Q<sub>A</sub>.</li>
<li>The shared secret value is n<sub>A</sub>Q<sub>B</sub> = n<sub>A</sub>(n<sub>B</sub>P) = n<sub>B</sub>(n<sub>A</sub>P) = n<sub>B</sub>Q<sub>A</sub></li>
</ol>
<p>It looks similar to the given DHKE algorithm, and seems promising, but... how does it work?</p>
</div>
</div>
<div class="section" id="ecs-and-ecc-q-a">
<h2>Elliptic Curves and Elliptic Curve Cryptography Q&amp;A</h2>
<p>To answer that we are going to answer the following:</p>
<ul class="simple">
<li>What are Elliptic Curves?</li>
<li>What does an Elliptic Curve look like?</li>
<li>What does it mean to multiply P by n?</li>
<li>What about a finite field?</li>
<li>How are the pubic keys used? Why are these a shared secret?</li>
<li>Why is Elliptic Curve Cryptography useful?</li>
</ul>
<div class="section" id="what-are-ecs">
<h3>What are Elliptic Curves?</h3>
<p>A Elliptic Curve is the set of solutions to an equation of the form</p>
<blockquote>
Y<sup>2</sup> = X<sup>3</sup> + AX + B</blockquote>
</div>
<div class="section" id="what-does-an-ec-look-like">
<h3>What does an Elliptic Curve look like?</h3>
<p>Two examples of Elliptic Curves are as follows:</p>
<img alt="A simple Elliptic Curve" class="align-center" src="/assets/images/independent-crypto/ecc-1.png" style="width: 100%;" />
<p>and:</p>
<img alt="Another simple Elliptic Curve" class="align-center" src="/assets/images/independent-crypto/ecc-2.png" style="width: 100%;" />
</div>
<div class="section" id="adding-p-and-q">
<h3>Adding P and Q</h3>
<p>Multiplication is <em>just</em> repeated addition.
Oh shoot we haven't said how &quot;addition&quot; happens on an Elliptic Curve.
Let's do that.</p>
<p>Addition is the process of drawing a line L between P and Q.
The third point that the line L intersects is point R.
When R is reflected over the X axis we call this R'.
The result of P ‚äï Q (read: P 'plus' Q) is R'.</p>
<p>We can enumerate these steps as:</p>
<ol class="arabic simple">
<li>Take two points P and Q on the Elliptic Curve E.</li>
<li>Draw a line L which passes through these two points.</li>
<li>L should ultimately pass through <em>three</em> points: P, Q, and R.</li>
<li>Multiply the Y coordinate of R by -1, this is R'.</li>
<li>P ‚äï Q = R'.</li>
</ol>
<p>Here's a visualization of straight forward addition.</p>
<img alt="Annotated curve E with points P, Q, R, R' and line L labeled." class="align-center" src="/assets/images/independent-crypto/ecc-3.png" style="width: 100%;" />
<p>You might think &quot;What happens when P is tangent a point on E?&quot;
In that case we say P = Q, so R = P ‚äï P, or R = 2P.
It looks like this:</p>
<img alt="Annotated curve E with points P, R, R' and line L labeled. P is tangent to the curve." class="align-center" src="/assets/images/independent-crypto/ecc-4.png" style="width: 100%;" />
<p>Wait a second, 2P looks like n*P which was one of the questions we had!
Don't worry, we'll get there soon.</p>
</div>
<div class="section" id="that-thing-about-finite-fields">
<h3>That thing about Finite Fields</h3>
<p>In practice we bound the curve over a field F<sub>p</sub> with p ‚â• 3.
We input {1, 2, ..., p-1} as the value of X in E and select the results which are squares modulo 13.</p>
<p>For example:</p>
<blockquote>
<div class="line-block">
<div class="line">E : Y<sup>2</sup> = X<sup>3</sup> + 3X + 8 over F<sub>13</sub></div>
<div class="line">X = 1</div>
<div class="line">1 + 3 + 8 = 12</div>
<div class="line">12 is a square (mod 13)</div>
</div>
</blockquote>
<p>Repeating this gives us the set of points in E(F<sub>13</sub>):</p>
<blockquote>
E(F<sub>13</sub>) = {O, (1,5), (1,8), (2,3), (2,10), (9,6), (9,7), (12,2), (12,11)}</blockquote>
<p>In practice this bounds the graph of E and forces us to draw a strange modulus graph shown below:</p>
<img alt="Elliptic Curves illustrated where each point is a valid coordinate. There are no curves." class="align-center" src="/assets/images/independent-crypto/ecc-5.gif" style="width: 100%;" />
<p><em>Image source: A (relatively easy to understand) primer on elliptic curve cryptography</em> <a class="footnote-reference" href="#id7" id="id1">[2]</a></p>
</div>
<div class="section" id="multiplying-p-by-an-integer-with-the-double-and-add-algorithm">
<h3>Multiplying P by an integer with The Double-and-Add Algorithm</h3>
<p>To &quot;multiply&quot; P by n we need to use the Double-and-Add Algorithm.
Here's how that looks:</p>
<ol class="arabic simple" start="0">
<li>Take a point P ‚àà E(F<sub>p</sub>) and an integer n ‚â• 1.</li>
<li>Set Q = P and R = O.</li>
<li>Loop while n &gt; 0.<ol class="arabic" start="3">
<li>If n ‚â° 1 (mod 2), set R = R + Q</li>
<li>Set Q = 2Q and n = floor(n/2).</li>
</ol>
</li>
</ol>
<ol class="arabic simple" start="5">
<li>Return the point R, which equals nP.</li>
</ol>
<p><em>Recall that the algorithm for finding point 2Q was covered in the above section</em> <a class="reference internal" href="#adding-p-and-q">Adding P and Q</a></p>
</div>
<div class="section" id="what-is-the-shared-secret">
<h3>What <em>is</em> the shared secret?</h3>
<p>Let's review.
The shared secret is the second point n<sub>A</sub>n<sub>B</sub>P, which is a point on the public curve E(F<sub>p</sub>).
This point can be used to encrypt information as it is a shared secret (necessary for DHKE).
How exactly it is used to encrypt information is left as an exercise for readers in charge of cryptographic implementation standards.</p>
<p>The reason this is a shared secret is because an adversary needs to solve the following Elliptic Curve Discrete Logarithm Problem</p>
<blockquote>
nP = Q<sub>A</sub></blockquote>
<p>Which is a very hard problem, as mentioned in the next section.</p>
</div>
</div>
<div class="section" id="an-example-of-ecc">
<h2>An example of Elliptic Curve Cryptography</h2>
<p>This sounds good in theory, but let's give it a test drive.</p>
<p>Alice and Bob are given the following shared information:</p>
<blockquote>
<div class="line-block">
<div class="line">p = 3851, E: Y<sup>2</sup> = X<sup>3</sup> + 324X + 1287, P = (920, 303) ‚àà E(F<sub>3851</sub>)</div>
</div>
</blockquote>
<p>Alice and Bob choose their secret integers:</p>
<blockquote>
<div class="line-block">
<div class="line">n<sub>A</sub> = 1194</div>
<div class="line">n<sub>B</sub> = 1759</div>
</div>
</blockquote>
<p>Alice and Bob then compute their public keys:</p>
<blockquote>
<div class="line-block">
<div class="line">Alice computes Q<sub>A</sub> = 1194P = (2067, 2178) ‚àà E(F<sub>3851</sub>)</div>
<div class="line">Bob computes Q<sub>B</sub> = 1759P = (3684, 3125) ‚àà E(F<sub>3851</sub>)</div>
</div>
</blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Remember that we use the Double-and-Add algorithm to compute Q<sub>A</sub> and Q<sub>B</sub>.
This invloves iteratively computing the tangent line at a point, the intersection with E at that intersection, and reflecting that point over the X axis.</p>
</div>
<p>Alice and Bob trade public keys and calculate their shared secret:</p>
<blockquote>
<div class="line-block">
<div class="line">Alice computes n<sub>A</sub>Q<sub>B</sub> = 1194(3684, 3125) = (3347, 1242) ‚àà E(F<sub>3851</sub>)</div>
<div class="line">Bob computes n<sub>B</sub>Q<sub>A</sub> = 1759(2067, 2178) = (3347, 1242) ‚àà E(F<sub>3851</sub>)</div>
</div>
</blockquote>
<p>Therefore (3347, 1242) is the shared secret.</p>
</div>
<div class="section" id="why-ecc-is-useful">
<h2>Why Elliptic Curve Cryptography is useful</h2>
<p>While it is harder than simply multiplying mod p for Alice to compute her shared secret (which is the case in RSA), it is <em>even harder</em> for a malicious actor to figure out that same shared secret.
This point is best put by the source <em>A (relatively easy to understand) primer on elliptic curve cryptography</em> <a class="footnote-reference" href="#id7" id="id2">[2]</a>:</p>
<blockquote>
You can compute how much energy is needed to break a cryptographic algorithm and compare that with how much water that energy could boil.
This is a kind of a cryptographic carbon footprint.
By this measure, breaking a 228-bit RSA key requires less energy than it takes to boil a teaspoon of water.
Comparatively, breaking a 228-bit elliptic curve key requires enough energy to boil all the water on earth.
For this level of security with RSA, you'd need a key with 2,380 bits.</blockquote>
<p>So an Elliptic Curve Cryptography key can be one magnitude smaller in size and offer the same level of security as RSA.</p>
<p>We can put this in more concrete terms: the fastest algorithm to solve the Elliptic Curve Discrete Logarithm Problem, which Elliptic DHKE security is built upon, in E(F<sub>p</sub>) takes ‚àöp steps.
This is much more difficult than the 'vanilla' Discrete Logarithm Problem.</p>
</div>
<div class="section" id="notes-and-edge-cases">
<h2>Notes and edge cases</h2>
<p>Elliptic Curve Cryptography, much like the rest of Cryptography, deals heavily with <a class="reference external" href="https://en.wikipedia.org/wiki/Number_theory">Number Theory</a>.
Despite my best efforts most of the nitty-gritty Number Theory in this topic went <em>way</em> over my head.
As a result I didn't include much of that kind of stuff and instead focused on the things I <em>could</em> share and sound smart about.</p>
<p>Here are some other things about Elliptic Curve Cryptography I didn't cover that deserve more air time:</p>
<ul class="simple">
<li>The Elliptic Curve chosen must meet a special set of criteria; any old Elliptic Curve won't do. This was the cause of a cryptographic breach with Elliptic Curve Cryptography a few years ago that triggered doubts about Elliptic Curve Cryptography as a whole.</li>
<li>Some primes cause solving the Elliptic Curve Discrete Logarithm Problem for E(F<sub>p</sub>) to be easier than the Discrete Logarithm Problem, these primes can be computed and should be avoided.</li>
<li>If you want a deeper understanding of the theory of Elliptic Curves (addition of points on these curves, etc) you should look into <a class="reference external" href="https://en.wikipedia.org/wiki/Algebraic_geometry">algebraic geometry</a>.</li>
</ul>
</div>
<div class="section" id="annotated-bibliography">
<h2>Annotated Bibliography</h2>
<dl class="docutils">
<dt>An Introduction to Mathematical Cryptography <a class="footnote-reference" href="#id6" id="id3">[1]</a></dt>
<dd>The chapter in this textbook on Elliptic Curves in Cryptography established the bedrock understanding of the topic of Elliptic Curve Cryptography.
This ended up being the main resource for this post and offered a great median between &quot;Regular Joe's guide to Elliptic Curve Cryptography&quot; and &quot;The graduate student's guide to Elliptic Curve Cryptography&quot; which were my other two resources.
It was also the source of all examples, which were very useful in gaining an intuitive understanding of the material.</dd>
<dt>A (relatively easy to understand) primer on elliptic curve cryptography <a class="footnote-reference" href="#id7" id="id4">[2]</a></dt>
<dd>This blog post was my <em>second</em> source and did a good job of taking the proofs and dense material in Intro to Math Cyrpto (above) and boiled it down to the important stuff.
It drastically improved further readings of the original textbook and provided that great animated image of adding P ‚äï Q in E(F<sub>p</sub>).
It didn't cover any of the Number Theory, but explained the historical context of Elliptic Curve Cryptography, roughly how/why it works, and did a good job of describing it's impact in our world today.</dd>
<dt>Cryptography: An Introduction <a class="footnote-reference" href="#id8" id="id5">[3]</a></dt>
<dd>This wasn't a resource I actually <em>used</em>, but I did read the chapter on Elliptic Curve Cryptography (chapter 2!).
It gave me an appreciation for the previous two sources and some exposure to the other ways Elliptic Curves can be taught.</dd>
</dl>
</div>
<div class="section" id="errata">
<h2>Errata</h2>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[1]</a></td><td>An Introduction to Mathematical Cryptography, 2008,
Jeffery Hoffstein, Jill Pipher, Joseph H. Silverman,
Springer Publishing, ISBN 978-0-387-77993-5</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>, <a class="fn-backref" href="#id4">3</a>)</em> A (relatively easy to understand) primer on elliptic curve cryptography,
October 24, 2013, Nick Sullivan,
Cloudflare blog, reposted on Ars Technica,
<a class="reference external" href="https://arstechnica.com/information-technology/2013/10/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography/">https://arstechnica.com/information-technology/2013/10/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[3]</a></td><td>Cryptography: An Introduction
(Third Edition), May 19, 2016, Nigel Smart,
<a class="reference external" href="https://www.cs.umd.edu/~waa/414-F11/IntroToCrypto.pdf">https://www.cs.umd.edu/~waa/414-F11/IntroToCrypto.pdf</a></td></tr>
</tbody>
</table>
<!-- ‚àÄ -->
</div>

</div>


      </div>

      <footer>
        <p>
        ¬© 2024 Elijah Voigt, <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="/assets/images/CCA4IL.png" /> Creative Commons Attribution 4.0 International</a>.
        </p>
        <p>
        This website made with locally sourced bits, built with Python üêç via Pelican üê¶, developed on Fedora üëí GNU/Linux üêÉüêß, <a href='https://github.com/pop/elijahcaine.me'>hosted</a> and deployed on GitHub üêôüê±, and served from clouds ‚õÖ.
        </p>
      </footer>
    </div>
  </body>
</html>